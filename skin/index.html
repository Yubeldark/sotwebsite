<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quel skin ?</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="icon" href="../images/favicon.ico" type="image/x-icon" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <img src="../images/logo_sotdle.png" alt="Logo SOTDLE" class="site-logo" onclick="window.location.href='../index.html'"/>

  <div class="game-container">
    <h1>ðŸŽ¨ Quel skin ?</h1>
    <p>Devine le skin mystÃ¨re en utilisant les indices de chaque tentative !</p>
    
    <select id="skinInput">
      <option disabled selected>Choisir un skin...</option>
    </select>
    
    <table id="guessTable">
      <thead>
        <tr>
          <th>Nom</th>
          <th>CatÃ©gorie</th>
          <th>Sous-catÃ©gorie</th>
          <th>Couleur</th>
          <th>Date</th>
          <th>Obtention</th>
          <th>Monnaie</th>
          <th>Image</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    
    <div id="feedback"></div>
    <div id="attempts"></div>
    <button id="resetButton" style="display: none;">Essayer Ã  nouveau</button>
  </div>

  <script>
    const skins = {
      "Voiles des Sombres aventuriers": {
        nom: "Voiles des Sombres aventuriers",
        categorie: "Personnalisation de bateau",
        sousCategorie: "Voile",
        couleur: ["Noir", "Gris"],
        date: "Saison 1",
        obtention: "Shop",
        prix: "Gold",
        image: "../images/voiles_des_sombres_aventuriers.png"
      },
      "Tromblon de Minuit": {
        nom: "Tromblon de Minuit",
        categorie: "Armurerie",
        sousCategorie: "Tromblon",
        couleur: ["Noir", "Gris", "Vert"],
        date: "Lancement",
        obtention: "Code, Giveaway",
        prix: "-",
        image: "../images/tromblon_de_minuit.png"
      },
      "Bell Brigade Streaked Hair": {
        nom: "Bell Brigade Streaked Hair",
        categorie: "Accessoire",
        sousCategorie: "Coiffure",
        couleur: [ ],
        date: "Saison 5",
        obtention: "Shop",
        prix: "Doublons",
        image: "../images/bell_brigade_streaked_hair.png"
      },
      "Arquebuse Ã  mire d'Obsidienne": {
        nom: "Arquebuse Ã  mire d'Obsidienne",
        categorie: "Armurerie",
        sousCategorie: "Arquebuse",
        couleur: ["Noir", "Gris", "Vert"],
        date: "Lancement",
        obtention: "Code, Giveaway",
        prix: "-",
        image: "../images/arquebuse_a_mire_d_obsidienne.png"
      },
      "Voiles de l'Ã¢ge d'or": {
        nom: "Voiles de l'Ã¢ge d'or",
        categorie: "Personnalisation de bateau",
        sousCategorie: "Voile",
        couleur: ["Beige"],
        date: "Saison 9",
        obtention: "Plunder Pass",
        prix: "-",
        image: "../images/voiles_de_l_age_d_or.png"
      },
      "Pantalon du Silver Blade": {
        nom: "Pantalon du Silver Blade",
        categorie: "Coffre de VÃªtements",
        sousCategorie: "Pantalon",
        couleur: ["Gris"],
        date: "Lancement",
        obtention: "RÃ©compense",
        prix: "-",
        image: "../images/pantalonsilver.png"
      },
      "MalÃ©diction CendrÃ©e": {
        nom: "MalÃ©diction CendrÃ©e",
        categorie: "Coffre d'accessoires",
        sousCategorie: "MalÃ©diction",
        couleur: ["Rouge"],
        date: "2020",
        obtention: "Promotion",
        prix: "-",
        image: "../images/ashencurse.png"
      },
      "Barbe de l'Horizon GelÃ©": {
        nom: "Barbe de l'Horizon GelÃ©",
        categorie: "Accessoire",
        sousCategorie: "Barbe",
        couleur: ["Bleu"],
        date: "2020",
        obtention: "Twitch Drops",
        prix: "-",
        image: "../images/barbegel.png"
      },
      "Coque de la ComÃ¨re Radieuse": {
        nom: "Coque de la ComÃ¨re Radieuse",
        categorie: "Personnalisation de bateau",
        sousCategorie: "Coque",
        couleur: ["Violet"],
        date: "Saison 13",
        obtention: "Pirate Emporium",
        prix: "PiÃ¨ces Anciennes",
        image: "../images/coquecomete.png"
      },
      "Tambour d'Aristocrate": {
        nom: "Tambour d'Aristocrate",
        categorie: "Coffre d'Ã©quipements",
        sousCategorie: "Tambour",
        couleur: ["Blanc", "Rose"],
        date: "Saison 2",
        obtention: "Shop",
        prix: "Doublons",
        image: "../images/tambourari.png"
      },
      "Haut du corps Pardessus": {
        nom: "Haut du corps Pardessus",
        categorie: "Coffre de VÃªtements",
        sousCategorie: "Torses",
        couleur: ["Gris", "Marron"],
        date: "Saison 8",
        obtention: "Shop",
        prix: "Gold",
        image: "../images/pardessus.png"
      },
      "DÃ©guisement de coffre de place forte": {
        nom: "DÃ©guisement de coffre de place forte",
        categorie: "Coffre d'accessoires",
        sousCategorie: "DÃ©guisement",
        couleur: ["Blanc", "Marron"],
        date: "Saison 14",
        obtention: "Shop",
        prix: "Gold",
        image: "../images/coffreplace.png"
      },
      "Costume de capitaine du Feu de l'Ã¢me": {
        nom: "Costume de capitaine du Feu de l'Ã¢me",
        categorie: "Coffre de VÃªtements",
        sousCategorie: "Costume",
        couleur: ["Vert"],
        date: "Fort of the Damned",
        obtention: "Shop",
        prix: "Gold",
        image: "../images/steelnightmare.png"
      },
      "Pistolet Ã  double cannon de la main veinarde": {
        nom: "Pistolet Ã  double cannon de la main veinarde",
        categorie: "Armurerie",
        sousCategorie: "Pistolet Ã  double canon",
        couleur: ["Gris", "Marron"],
        date: "Saison 14",
        obtention: "Shop",
        prix: "Doublons",
        image: "../images/luckygun.png"
      },
      "Lanterne de navire brÃ»lÃ©e par la neige": {
        nom: "Lanterne de navire brÃ»lÃ©e par la neige",
        categorie: "Coffre d'Ã©quipements",
        sousCategorie: "Lanterne",
        couleur: ["Rouge", "Vert"],
        date: "Saison 8",
        obtention: "RÃ©compense",
        prix: "-",
        image: "../images/snowburn.png"
      },
      "Canon de loup de mer triomphant": {
        nom: "Canon de loup de mer triomphant",
        categorie: "Personnalisation de bateau",
        sousCategorie: "Canon",
        couleur: ["Bleu"],
        date: "2019",
        obtention: "Shop",
        prix: "Gold",
        image: "../images/canontsd.png"
      },
      "Chemise de la marÃ©e de l'ombre": {
        nom: "Chemise de la marÃ©e de l'ombre",
        categorie: "Coffre de VÃªtements",
        sousCategorie: "Chemise",
        couleur: ["Gris", "Noir"],
        date: "Saison 14",
        obtention: "Plunder Pass",
        prix: "-",
        image: "../images/shirt14.png"
      },
      "Tatouage de la bÃ©nÃ©diction sylvestre": {
        nom: "Tatouage de la bÃ©nÃ©diction sylvestre",
        categorie: "Malle d'accessoires",
        sousCategorie: "Tatouage",
        couleur: ["Noir"],
        date: "Saison 6",
        obtention: "Pirate Emporium",
        prix: "PiÃ¨ces Anciennes",
        image: "../images/forest.png"
      }
    };

    // Nombre maximum de tentatives
    const MAX_ATTEMPTS = 6;
    let attempts = 0;
    let gameOver = false;
    let guessedSkins = []; // Pour stocker les skins dÃ©jÃ  tentÃ©s

    // Fonction pour sÃ©lectionner un nouveau skin alÃ©atoire
    function selectRandomSkin() {
      const skinNames = Object.keys(skins);
      return skinNames[Math.floor(Math.random() * skinNames.length)];
    }

    let correctName = selectRandomSkin();
    let correctSkin = skins[correctName];

    const input = document.getElementById("skinInput");
    const tbody = document.querySelector("#guessTable tbody");
    const feedback = document.getElementById("feedback");
    const attemptsDisplay = document.getElementById("attempts");
    const resetButton = document.getElementById("resetButton");

    // Afficher le compteur de tentatives
    attemptsDisplay.textContent = `Tentative: 0/${MAX_ATTEMPTS}`;

    // Trier les noms de skin par ordre alphabÃ©tique
    const sortedSkinNames = Object.keys(skins).sort();
    sortedSkinNames.forEach(name => {
      const option = document.createElement("option");
      option.value = name;
      option.textContent = name;
      input.appendChild(option);
    });

    // Fonction pour rÃ©initialiser le jeu
    function resetGame() {
      // RÃ©initialiser les variables du jeu
      attempts = 0;
      gameOver = false;
      guessedSkins = []; // RÃ©initialiser la liste des skins devinÃ©s
      
      // SÃ©lectionner un nouveau skin alÃ©atoire
      correctName = selectRandomSkin();
      correctSkin = skins[correctName];
      
      // Effacer les rÃ©sultats prÃ©cÃ©dents
      tbody.innerHTML = '';
      feedback.textContent = '';
      feedback.classList.remove('success', 'failure', 'show');
      
      // RÃ©initialiser l'interface
      input.disabled = false;
      input.value = "Choisir un skin...";
      attemptsDisplay.textContent = `Tentative: 0/${MAX_ATTEMPTS}`;
      attemptsDisplay.classList.remove('warning', 'danger');
      
      // Cacher le bouton de rÃ©initialisation
      resetButton.style.display = 'none';
      resetButton.classList.remove('replay-button', 'show');
      
      // Supprimer les containers de confettis s'il en reste
      const confettiContainers = document.querySelectorAll('.confetti-container');
      confettiContainers.forEach(container => {
        if (container.parentNode) {
          container.parentNode.removeChild(container);
        }
      });

      // RÃ©activer toutes les options du menu dÃ©roulant
      Array.from(input.options).forEach(option => {
        option.disabled = false;
      });
    }

    // Gestionnaire d'Ã©vÃ©nement pour le bouton de rÃ©initialisation
    resetButton.addEventListener('click', resetGame);

    // Ajouter l'en-tÃªte du tableau au chargement de la page
    document.addEventListener("DOMContentLoaded", function() {
      // CrÃ©er l'en-tÃªte du tableau s'il n'existe pas dÃ©jÃ 
      const thead = document.querySelector("#guessTable thead");
      if (thead.children.length === 0) {
        const headerRow = document.createElement("tr");
        
        // Changer "Prix" par "Monnaie" dans les en-tÃªtes
        const headers = ["Nom", "CatÃ©gorie", "Sous-catÃ©gorie", "Couleur", "Date", "Obtention", "Monnaie", "Image"];
        
        headers.forEach(headerText => {
          const th = document.createElement("th");
          th.textContent = headerText;
          headerRow.appendChild(th);
        });
        
        thead.appendChild(headerRow);
      }
    });

    // Fonction pour convertir les dates en valeurs numÃ©riques comparables
    function convertDateToValue(dateString) {
      // Tableau des dates dans l'ordre chronologique
      const dateOrder = [
        "BÃªta",
        "Lancement",
        "2018",
        "Anniversary",
        "2019",
        "Fort of the Damned",
        "2020",
        "Ships of Fortune",
        "2021",
        "Saison 1",
        "Saison 2",
        "Saison 3",
        "Saison 4",
        "Saison 5",
        "Saison 6",
        "Saison 7",
        "Saison 8",
        "Saison 9",
        "Saison 10",
        "Saison 11",
        "Saison 12",
        "Saison 13",
        "Saison 14",
        "Saison 15"
      ];
      
      // Trouver l'index de la date dans le tableau
      const index = dateOrder.indexOf(dateString);
      
      // Si la date n'est pas trouvÃ©e dans le tableau, retourner une valeur Ã©levÃ©e
      return index === -1 ? 999 : index;
    }

    // Modifier la portion du code qui gÃ¨re le changement de sÃ©lection pour ajouter l'image Ã  chaque fois
    input.addEventListener("change", () => {
      if (gameOver) return;
      
      const guess = input.value;
      if (!guess || !skins[guess] || guessedSkins.includes(guess)) {
        input.value = "Choisir un skin...";
        return;
      }

      // Ajouter le skin Ã  la liste des skins devinÃ©s
      guessedSkins.push(guess);
      
      // DÃ©sactiver l'option dans le menu dÃ©roulant
      Array.from(input.options).forEach(option => {
        if (option.value === guess) {
          option.disabled = true;
        }
      });

      attempts++;
      
      // Mettre Ã  jour l'affichage des tentatives
      attemptsDisplay.textContent = `Tentative: ${attempts}/${MAX_ATTEMPTS}`;
      
      // Ajouter des classes d'avertissement visuel
      if (attempts >= MAX_ATTEMPTS - 1) {
        attemptsDisplay.classList.add('danger');
      } else if (attempts >= MAX_ATTEMPTS - 2) {
        attemptsDisplay.classList.add('warning');
      }

      const skin = skins[guess];
      const row = document.createElement("tr");
      row.className = "new-row"; // Ajouter la classe pour l'animation
      
      // D'abord ajouter les cellules standards
      const fields = ["nom", "categorie", "sousCategorie", "couleur", "date", "obtention", "prix"];
      fields.forEach(field => {
        const td = document.createElement("td");
        
        if (field === "couleur" && Array.isArray(skin[field])) {
          td.textContent = skin[field].join(", ");
        } else {
          td.textContent = skin[field] || "-";
        }
        
        // Ajouter des classes pour la mise en Ã©vidence des correspondances
        if (correctSkin[field] === skin[field] || 
            (field === "couleur" && Array.isArray(skin[field]) && 
             JSON.stringify(skin[field].sort()) === JSON.stringify(correctSkin[field].sort()))) {
          td.classList.add("correct");
        } else if (field === "couleur" && Array.isArray(skin[field]) && 
                  Array.isArray(correctSkin[field]) && 
                  skin[field].some(c => correctSkin[field].includes(c))) {
          td.classList.add("partial");
        } else {
          td.classList.add("incorrect");
          
          // Ajouter les indicateurs chronologiques pour la colonne date
          if (field === "date") {
            const guessDateValue = convertDateToValue(skin[field]);
            const correctDateValue = convertDateToValue(correctSkin[field]);
            
            // Alternative avec des caractÃ¨res Unicode de flÃ¨ches
            if (guessDateValue < correctDateValue) {
              td.innerHTML = `${skin[field]} <span class="date-indicator earlier">â†‘</span>`;
            } else if (guessDateValue > correctDateValue) {
              td.innerHTML = `${skin[field]} <span class="date-indicator later">â†“</span>`;
            }
          }
        }
        
        row.appendChild(td);
      });
      
      // Ensuite ajouter la cellule d'image Ã  la fin
      const imageTd = document.createElement("td");
      imageTd.className = "image-cell";
      
      const img = document.createElement("img");
      img.src = skin.image;
      img.alt = skin.nom;
      img.className = "skin-image";
      imageTd.appendChild(img);
      
      row.appendChild(imageTd);
      
      tbody.appendChild(row);
      
      // VÃ©rifier si la rÃ©ponse est correcte
      if (guess === correctName) {
        gameOver = true;
        
        // SÃ©paration plus claire du message de fÃ©licitation
        feedback.innerHTML = "<div class='celebration-text'>FÃ©licitations!</div>" + 
                             "<div class='success-message'>ðŸŽ‰ Vous avez trouvÃ© le skin correct ! ðŸŽ‰</div>";
        feedback.classList.add("success", "show");
        
        // Le reste du code reste identique
        resetButton.textContent = "ðŸŽ® Rejouer";
        resetButton.style.display = "block";
        resetButton.classList.add("replay-button", "show");
        
        // Ajouter une animation de confettis
        const confettiContainer = document.createElement("div");
        confettiContainer.className = "confetti-container";
        
        // CrÃ©er plusieurs confettis
        for (let i = 0; i < 50; i++) {
          const confetti = document.createElement("div");
          confetti.className = "confetti";
          confetti.style.left = Math.random() * 100 + "%";
          confetti.style.animationDelay = Math.random() * 3 + "s";
          confetti.style.background = `hsl(${Math.random() * 360}, 80%, 60%)`;
          confettiContainer.appendChild(confetti);
        }
        
        document.querySelector(".game-container").appendChild(confettiContainer);
        
      } else if (attempts >= MAX_ATTEMPTS) {
        gameOver = true;
        feedback.textContent = `ðŸ’€ Perdu ! Le skin correct Ã©tait: ${correctName}`;
        feedback.classList.add("failure", "show"); // Ajouter show pour l'animation
        resetButton.textContent = "Essayer Ã  nouveau";
        resetButton.style.display = "block";
        resetButton.classList.add("show"); // Ajouter show pour l'animation
      }
      
      input.value = "Choisir un skin...";
    });
  </script>
</body>
</html>
